(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[17],{515:function(e,t,r){"use strict";r.r(t);var a=r(0),o=r(2),i=r(1),n=r.n(i),s=r(27),c=r(8),l=r(538),m=r(69);const{addCesSurveyForAnalytics:d}=Object(c.dispatch)(m.c),u=Object(s.applyFilters)("woocommerce_admin_variations_report_charts",[{key:"items_sold",label:Object(o.__)("Items sold","woocommerce-admin"),order:"desc",orderby:"items_sold",type:"number"},{key:"net_revenue",label:Object(o.__)("Net sales","woocommerce-admin"),order:"desc",orderby:"net_revenue",type:"currency"},{key:"orders_count",label:Object(o.__)("Orders","woocommerce-admin"),order:"desc",orderby:"orders_count",type:"number"}]),b=Object(s.applyFilters)("woocommerce_admin_variations_report_filters",[{label:Object(o.__)("Show","woocommerce-admin"),staticParams:["chartType","paged","per_page"],param:"filter-variations",showFilters:()=>!0,filters:[{label:Object(o.__)("All variations","woocommerce-admin"),chartMode:"item-comparison",value:"all"},{label:Object(o.__)("Single variation","woocommerce-admin"),value:"select_variation",subFilters:[{component:"Search",value:"single_variation",path:["select_variation"],settings:{type:"variations",param:"variations",getLabels:l.g,labels:{placeholder:Object(o.__)("Type to search for a variation","woocommerce-admin"),button:Object(o.__)("Single variation","woocommerce-admin")}}}]},{label:Object(o.__)("Comparison","woocommerce-admin"),chartMode:"item-comparison",value:"compare-variations",settings:{type:"variations",param:"variations",getLabels:l.g,labels:{helpText:Object(o.__)("Check at least two variations below to compare","woocommerce-admin"),placeholder:Object(o.__)("Search for variations to compare","woocommerce-admin"),title:Object(o.__)("Compare Variations","woocommerce-admin"),update:Object(o.__)("Compare","woocommerce-admin")},onClick:d}},{label:Object(o.__)("Advanced filters","woocommerce-admin"),value:"advanced"}]}]),p=Object(s.applyFilters)("woocommerce_admin_variations_report_advanced_filters",{title:Object(o._x)("Variations match {{select /}} filters","A sentence describing filters for Variations. See screen shot for context: https://cloudup.com/cSsUY9VeCVJ","woocommerce-admin"),filters:{attribute:{allowMultiple:!0,labels:{add:Object(o.__)("Attribute","woocommerce-admin"),placeholder:Object(o.__)("Search attributes","woocommerce-admin"),remove:Object(o.__)("Remove attribute filter","woocommerce-admin"),rule:Object(o.__)("Select a product attribute filter match","woocommerce-admin"),title:Object(o.__)("{{title}}Attribute{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(o.__)("Select attributes","woocommerce-admin")},rules:[{value:"is",label:Object(o._x)("Is","product attribute","woocommerce-admin")},{value:"is_not",label:Object(o._x)("Is Not","product attribute","woocommerce-admin")}],input:{component:"ProductAttribute"}},category:{labels:{add:Object(o.__)("Categories","woocommerce-admin"),placeholder:Object(o.__)("Search categories","woocommerce-admin"),remove:Object(o.__)("Remove categories filter","woocommerce-admin"),rule:Object(o.__)("Select a category filter match","woocommerce-admin"),title:Object(o.__)("{{title}}Category{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(o.__)("Select categories","woocommerce-admin")},rules:[{value:"includes",label:Object(o._x)("Includes","categories","woocommerce-admin")},{value:"excludes",label:Object(o._x)("Excludes","categories","woocommerce-admin")}],input:{component:"Search",type:"categories",getLabels:l.a}},product:{labels:{add:Object(o.__)("Products","woocommerce-admin"),placeholder:Object(o.__)("Search products","woocommerce-admin"),remove:Object(o.__)("Remove products filter","woocommerce-admin"),rule:Object(o.__)("Select a product filter match","woocommerce-admin"),title:Object(o.__)("{{title}}Product{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(o.__)("Select products","woocommerce-admin")},rules:[{value:"includes",label:Object(o._x)("Includes","products","woocommerce-admin")},{value:"excludes",label:Object(o._x)("Excludes","products","woocommerce-admin")}],input:{component:"Search",type:"variableProducts",getLabels:l.d}}}});var y=r(542),_=r(540),g=r(537),h=r(543),f=r(564),v=r(544);const O=e=>{const{itemsLabel:t,mode:r}=(e=>{let{query:t}=e;const r="compare-variations"===t["filter-variations"]&&t.variations&&t.variations.split(",").length>1;return{compareObject:"variations",itemsLabel:Object(o.__)("%d variations","woocommerce-admin"),mode:r?"item-comparison":"time-comparison"}})(e),{path:i,query:n,isError:s,isRequesting:c}=e;if(s)return Object(a.createElement)(g.a,null);const l={...n};return"item-comparison"===r&&(l.segmentby="variation"),Object(a.createElement)(a.Fragment,null,Object(a.createElement)(v.a,{query:n,path:i,filters:b,advancedFilters:p,report:"variations"}),Object(a.createElement)(h.a,{mode:r,charts:u,endpoint:"variations",isRequesting:c,query:l,selectedChart:Object(y.a)(n.chart,u),filters:b,advancedFilters:p}),Object(a.createElement)(_.a,{charts:u,mode:r,filters:b,advancedFilters:p,endpoint:"variations",isRequesting:c,itemsLabel:t,path:i,query:l,selectedChart:Object(y.a)(l.chart,u)}),Object(a.createElement)(f.a,{isRequesting:c,query:n,filters:b,advancedFilters:p}))};O.propTypes={path:n.a.string.isRequired,query:n.a.object.isRequired};t.default=O},538:function(e,t,r){"use strict";r.d(t,"e",(function(){return d})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return y})),r.d(t,"f",(function(){return _})),r.d(t,"h",(function(){return g})),r.d(t,"g",(function(){return h}));var a=r(16),o=r(21),i=r.n(o),n=r(5),s=r(13),c=r(12),l=r(539),m=r(23);function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.identity;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;const n="function"==typeof e?e(o):e,c=Object(s.getIdsFromQuery)(r);if(c.length<1)return Promise.resolve([]);const l={include:c.join(","),per_page:c.length};return i()({path:Object(a.addQueryArgs)(n,l)}).then(e=>e.map(t))}}d(c.NAMESPACE+"/products/attributes",e=>({key:e.id,label:e.name}));const u=d(c.NAMESPACE+"/products/categories",e=>({key:e.id,label:e.name})),b=d(c.NAMESPACE+"/coupons",e=>({key:e.id,label:e.code})),p=d(c.NAMESPACE+"/customers",e=>({key:e.id,label:e.name})),y=d(c.NAMESPACE+"/products",e=>({key:e.id,label:e.name})),_=d(c.NAMESPACE+"/taxes",e=>({key:e.id,label:Object(l.a)(e)}));function g(e){let{attributes:t,name:r}=e;const a=Object(m.d)("variationTitleAttributesSeparator"," - ");if(r&&r.indexOf(a)>-1)return r;const o=(t||[]).map(e=>{let{option:t}=e;return t}).join(", ");return o?r+a+o:r}const h=d(e=>{let{products:t}=e;return t?c.NAMESPACE+`/products/${t}/variations`:c.NAMESPACE+"/variations"},e=>({key:e.id,label:g(e)}))},539:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(2);function o(e){return[e.country,e.state,e.name||Object(a.__)("TAX","woocommerce-admin"),e.priority].map(e=>e.toString().toUpperCase().trim()).filter(Boolean).join("-")}},540:function(e,t,r){"use strict";var a=r(0),o=r(2),i=r(14),n=r(68),s=r(8),c=r(5),l=r(1),m=r.n(l),d=r(22),u=r(12),b=r(20),p=r(536),y=r(537),_=r(13);function g(e){return t=>Object(n.format)(e,t)}class h extends a.Component{shouldComponentUpdate(e){return e.isRequesting!==this.props.isRequesting||e.primaryData.isRequesting!==this.props.primaryData.isRequesting||e.secondaryData.isRequesting!==this.props.secondaryData.isRequesting||!Object(c.isEqual)(e.query,this.props.query)}getItemChartData(){const{primaryData:e,selectedChart:t}=this.props;return e.data.intervals.map((function(e){const r={};return e.subtotals.segments.forEach((function(e){if(e.segment_label){const a=r[e.segment_label]?e.segment_label+" (#"+e.segment_id+")":e.segment_label;r[e.segment_id]={label:a,value:e.subtotals[t.key]||0}}})),{date:Object(n.format)("Y-m-d\\TH:i:s",e.date_start),...r}}))}getTimeChartData(){const{query:e,primaryData:t,secondaryData:r,selectedChart:a,defaultDateRange:o}=this.props,i=Object(b.getIntervalForQuery)(e,o),{primary:s,secondary:c}=Object(b.getCurrentDates)(e,o);return t.data.intervals.map((function(t,o){const l=Object(b.getPreviousDate)(t.date_start,s.after,c.after,e.compare,i),m=r.data.intervals[o];return{date:Object(n.format)("Y-m-d\\TH:i:s",t.date_start),primary:{label:`${s.label} (${s.range})`,labelDate:t.date_start,value:t.subtotals[a.key]||0},secondary:{label:`${c.label} (${c.range})`,labelDate:l.format("YYYY-MM-DD HH:mm:ss"),value:m&&m.subtotals[a.key]||0}}}))}getTimeChartTotals(){const{primaryData:e,secondaryData:t,selectedChart:r}=this.props;return{primary:Object(c.get)(e,["data","totals",r.key],null),secondary:Object(c.get)(t,["data","totals",r.key],null)}}renderChart(e,t,r,i){const{emptySearchResults:n,filterParam:s,interactiveLegend:c,itemsLabel:l,legendPosition:m,path:p,query:y,selectedChart:_,showHeaderControls:h,primaryData:f,defaultDateRange:v}=this.props,O=Object(b.getIntervalForQuery)(y,v),j=Object(b.getAllowedIntervalsForQuery)(y,v),w=Object(b.getDateFormatsForInterval)(O,f.data.intervals.length,{type:"php"}),C=n?Object(o.__)("No data for the current search","woocommerce-admin"):Object(o.__)("No data for the selected date range","woocommerce-admin"),{formatAmount:S,getCurrencyConfig:R}=this.context;return Object(a.createElement)(d.Chart,{allowedIntervals:j,data:r,dateParser:"%Y-%m-%dT%H:%M:%S",emptyMessage:C,filterParam:s,interactiveLegend:c,interval:O,isRequesting:t,itemsLabel:l,legendPosition:m,legendTotals:i,mode:e,path:p,query:y,screenReaderFormat:g(w.screenReaderFormat),showHeaderControls:h,title:_.label,tooltipLabelFormat:g(w.tooltipLabelFormat),tooltipTitle:"time-comparison"===e&&_.label||null,tooltipValueFormat:Object(u.getTooltipValueFormat)(_.type,S),chartType:Object(b.getChartTypeForQuery)(y),valueType:_.type,xFormat:g(w.xFormat),x2Format:g(w.x2Format),currency:R()})}renderItemComparison(){const{isRequesting:e,primaryData:t}=this.props;if(t.isError)return Object(a.createElement)(y.a,null);const r=e||t.isRequesting,o=this.getItemChartData();return this.renderChart("item-comparison",r,o)}renderTimeComparison(){const{isRequesting:e,primaryData:t,secondaryData:r}=this.props;if(!t||t.isError||r.isError)return Object(a.createElement)(y.a,null);const o=e||t.isRequesting||r.isRequesting,i=this.getTimeChartData(),n=this.getTimeChartTotals();return this.renderChart("time-comparison",o,i,n)}render(){const{mode:e}=this.props;return"item-comparison"===e?this.renderItemComparison():this.renderTimeComparison()}}h.contextType=p.a,h.propTypes={filters:m.a.array,isRequesting:m.a.bool,itemsLabel:m.a.string,limitProperties:m.a.array,mode:m.a.string,path:m.a.string.isRequired,primaryData:m.a.object,query:m.a.object.isRequired,secondaryData:m.a.object,selectedChart:m.a.shape({key:m.a.string.isRequired,label:m.a.string.isRequired,order:m.a.oneOf(["asc","desc"]),orderby:m.a.string,type:m.a.oneOf(["average","number","currency"]).isRequired}).isRequired},h.defaultProps={isRequesting:!1,primaryData:{data:{intervals:[]},isError:!1,isRequesting:!1},secondaryData:{data:{intervals:[]},isError:!1,isRequesting:!1}};t.a=Object(i.compose)(Object(s.withSelect)((e,t)=>{const{charts:r,endpoint:a,filters:o,isRequesting:i,limitProperties:n,query:s,advancedFilters:l}=t,m=n||[a],d=function e(t,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||0===t.length)return null;const o=t.slice(0),i=o.pop();if(i.showFilters(r,a)){const e=Object(_.flattenFilters)(i.filters),t=r[i.param]||i.defaultValue||"all";return Object(c.find)(e,{value:t})}return e(o,r,a)}(o,s),b=Object(c.get)(d,["settings","param"]),p=t.mode||function(e,t){if(e&&t){const r=Object(c.get)(e,["settings","param"]);if(!r||Object.keys(t).includes(r))return Object(c.get)(e,["chartMode"])}return null}(d,s)||"time-comparison",{woocommerce_default_date_range:y}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),g=e(u.REPORTS_STORE_NAME),h={mode:p,filterParam:b,defaultDateRange:y};if(i)return h;const f=m.some(e=>s[e]&&s[e].length);if(s.search&&!f)return{...h,emptySearchResults:!0};const v=r&&r.map(e=>e.key),O=Object(u.getReportChartData)({endpoint:a,dataType:"primary",query:s,selector:g,limitBy:m,filters:o,advancedFilters:l,defaultDateRange:y,fields:v});if("item-comparison"===p)return{...h,primaryData:O};const j=Object(u.getReportChartData)({endpoint:a,dataType:"secondary",query:s,selector:g,limitBy:m,filters:o,advancedFilters:l,defaultDateRange:y,fields:v});return{...h,primaryData:O,secondaryData:j}}))(h)},542:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(5);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=Object(a.find)(t,{key:e});return r||t[0]}},543:function(e,t,r){"use strict";var a=r(0),o=r(2),i=r(14),n=r(8),s=r(1),c=r.n(s),l=r(13),m=r(22),d=r(136),u=r(12),b=r(20),p=r(17),y=r(537),_=r(536);class g extends a.Component{formatVal(e,t){const{formatAmount:r,getCurrencyConfig:a}=this.context;return"currency"===t?r(e):Object(d.formatValue)(a(),t,e)}getValues(e,t){const{emptySearchResults:r,summaryData:a}=this.props,{totals:o}=a,i=o.primary?o.primary[e]:0,n=o.secondary?o.secondary[e]:0,s=r?0:i,c=r?0:n;return{delta:Object(d.calculateDelta)(s,c),prevValue:this.formatVal(c,t),value:this.formatVal(s,t)}}render(){const{charts:e,query:t,selectedChart:r,summaryData:i,endpoint:n,report:s,defaultDateRange:c}=this.props,{isError:d,isRequesting:u}=i;if(d)return Object(a.createElement)(y.a,null);if(u)return Object(a.createElement)(m.SummaryListPlaceholder,{numberOfItems:e.length});const{compare:_}=Object(b.getDateParamsFromQuery)(t,c);return Object(a.createElement)(m.SummaryList,null,t=>{let{onToggle:i}=t;return e.map(e=>{const{key:t,order:c,orderby:d,label:u,type:b,isReverseTrend:y,labelTooltipText:g}=e,h={chart:t};d&&(h.orderby=d),c&&(h.order=c);const f=Object(l.getNewPath)(h),v=r.key===t,{delta:O,prevValue:j,value:w}=this.getValues(t,b);return Object(a.createElement)(m.SummaryNumber,{key:t,delta:O,href:f,label:u,reverseTrend:y,prevLabel:"previous_period"===_?Object(o.__)("Previous period:","woocommerce-admin"):Object(o.__)("Previous year:","woocommerce-admin"),prevValue:j,selected:v,value:w,labelTooltipText:g,onLinkClickCallback:()=>{i&&i(),Object(p.recordEvent)("analytics_chart_tab_click",{report:s||n,key:t})}})})})}}g.propTypes={charts:c.a.array.isRequired,endpoint:c.a.string.isRequired,limitProperties:c.a.array,query:c.a.object.isRequired,selectedChart:c.a.shape({key:c.a.string.isRequired,label:c.a.string.isRequired,order:c.a.oneOf(["asc","desc"]),orderby:c.a.string,type:c.a.oneOf(["average","number","currency"]).isRequired}).isRequired,summaryData:c.a.object,report:c.a.string},g.defaultProps={summaryData:{totals:{primary:{},secondary:{}},isError:!1}},g.contextType=_.a,t.a=Object(i.compose)(Object(n.withSelect)((e,t)=>{const{charts:r,endpoint:a,limitProperties:o,query:i,filters:n,advancedFilters:s}=t,c=o||[a],l=c.some(e=>i[e]&&i[e].length);if(i.search&&!l)return{emptySearchResults:!0};const m=r&&r.map(e=>e.key),{woocommerce_default_date_range:d}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{summaryData:Object(u.getSummaryNumbers)({endpoint:a,query:i,select:e,limitBy:c,filters:n,advancedFilters:s,defaultDateRange:d,fields:m}),defaultDateRange:d}}))(g)},554:function(e,t,r){"use strict";function a(e,t,r){return!!t&&(e&&t<=r==="instock")}r.d(t,"a",(function(){return a}))},564:function(e,t,r){"use strict";var a=r(0),o=r(2),i=r(5),n=r(22),s=r(13),c=r(136),l=r(15),m=r(545),d=r(554),u=r(536),b=r(538),p=r(23);const y=Object(p.d)("manageStock","no"),_=Object(p.d)("stockStatuses",{});class g extends a.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:Object(o.__)("Product / Variation title","woocommerce-admin"),key:"name",required:!0,isLeftAligned:!0},{label:Object(o.__)("SKU","woocommerce-admin"),key:"sku",hiddenByDefault:!0,isSortable:!0},{label:Object(o.__)("Items sold","woocommerce-admin"),key:"items_sold",required:!0,defaultSort:!0,isSortable:!0,isNumeric:!0},{label:Object(o.__)("Net sales","woocommerce-admin"),screenReaderLabel:Object(o.__)("Net sales","woocommerce-admin"),key:"net_revenue",required:!0,isSortable:!0,isNumeric:!0},{label:Object(o.__)("Orders","woocommerce-admin"),key:"orders_count",isSortable:!0,isNumeric:!0},"yes"===y?{label:Object(o.__)("Status","woocommerce-admin"),key:"stock_status"}:null,"yes"===y?{label:Object(o.__)("Stock","woocommerce-admin"),key:"stock",isNumeric:!0}:null].filter(Boolean)}getRowsContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const{query:t}=this.props,r=Object(s.getPersistedQuery)(t),{formatAmount:m,formatDecimal:u,getCurrencyConfig:p}=this.context;return Object(i.map)(e,e=>{const{items_sold:t,net_revenue:i,orders_count:g,product_id:h,variation_id:f}=e,v=e.extended_info||{},{stock_status:O,stock_quantity:j,low_stock_amount:w,deleted:C,sku:S}=v,R=(q=e,Object(b.h)(q.extended_info||{}));var q;const k=Object(s.getNewPath)(r,"/analytics/orders",{filter:"advanced",variation_includes:f}),E=Object(l.getAdminLink)(`post.php?post=${h}&action=edit`);return[{display:C?R+" "+Object(o.__)("(Deleted)"," woocommerce-admin"):Object(a.createElement)(n.Link,{href:E,type:"wp-admin"},R),value:R},{display:S,value:S},{display:Object(c.formatValue)(p(),"number",t),value:t},{display:m(i),value:u(i)},{display:Object(a.createElement)(n.Link,{href:k,type:"wc-admin"},g),value:g},"yes"===y?{display:Object(d.a)(O,j,w)?Object(a.createElement)(n.Link,{href:E,type:"wp-admin"},Object(o._x)("Low","Indication of a low quantity","woocommerce-admin")):_[O],value:_[O]}:null,"yes"===y?{display:j,value:j}:null].filter(Boolean)})}getSummary(e){const{variations_count:t=0,items_sold:r=0,net_revenue:a=0,orders_count:i=0}=e,{formatAmount:n,getCurrencyConfig:s}=this.context,l=s();return[{label:Object(o._n)("variation sold","variations sold",t,"woocommerce-admin"),value:Object(c.formatValue)(l,"number",t)},{label:Object(o._n)("item sold","items sold",r,"woocommerce-admin"),value:Object(c.formatValue)(l,"number",r)},{label:Object(o.__)("net sales","woocommerce-admin"),value:n(a)},{label:Object(o._n)("orders","orders",i,"woocommerce-admin"),value:Object(c.formatValue)(l,"number",i)}]}render(){const{advancedFilters:e,baseSearchQuery:t,filters:r,isRequesting:i,query:n}=this.props,s={helpText:Object(o.__)("Check at least two variations below to compare","woocommerce-admin"),placeholder:Object(o.__)("Search by variation name or SKU","woocommerce-admin")};return Object(a.createElement)(m.a,{baseSearchQuery:t,compareBy:"variations",compareParam:"filter-variations",endpoint:"variations",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,isRequesting:i,itemIdField:"variation_id",labels:s,query:n,getSummary:this.getSummary,summaryFields:["variations_count","items_sold","net_revenue","orders_count"],tableQuery:{orderby:n.orderby||"items_sold",order:n.order||"desc",extended_info:!0,product_includes:n.product_includes,variations:n.variations},title:Object(o.__)("Variations","woocommerce-admin"),columnPrefsKey:"variations_report_columns",filters:r,advancedFilters:e})}}g.contextType=u.a,t.a=g}}]);