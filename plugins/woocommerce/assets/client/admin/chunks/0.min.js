(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[0],{536:function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var a=r(0),o=r(27),c=r(101),n=r.n(c),s=r(23);const i=n()(s.a),l=e=>{const t=i.getCurrencyConfig(),r=Object(o.applyFilters)("woocommerce_admin_report_currency",t,e);return n()(r)},d=Object(a.createContext)(i)},537:function(e,t,r){"use strict";var a=r(0),o=r(2),c=r(1),n=r.n(c),s=r(22);function i(e){let{className:t}=e;const r=Object(o.__)("There was an error getting your stats. Please try again.","woocommerce-admin"),c=Object(o.__)("Reload","woocommerce-admin");return Object(a.createElement)(s.EmptyContent,{className:t,title:r,actionLabel:c,actionCallback:()=>{window.location.reload()}})}i.propTypes={className:n.a.string},t.a=i},544:function(e,t,r){"use strict";var a=r(0),o=r(14),c=r(1),n=r.n(c),s=r(5),i=r(8),l=r(22),d=r(12),m=r(20),u=r(17),b=r(536),p=r(69),g=r(23);class y extends a.Component{constructor(){super(),this.onDateSelect=this.onDateSelect.bind(this),this.onFilterSelect=this.onFilterSelect.bind(this),this.onAdvancedFilterAction=this.onAdvancedFilterAction.bind(this)}onDateSelect(e){const{report:t,addCesSurveyForAnalytics:r}=this.props;r(),Object(u.recordEvent)("datepicker_update",{report:t,...Object(s.omitBy)(e,s.isUndefined)})}onFilterSelect(e){const{report:t,addCesSurveyForAnalytics:r}=this.props,a=e.filter||e["filter-variations"];["single_product","single_category","single_coupon","single_variation"].includes(a)&&r();const o={report:t,filter:e.filter||"all"};"single_product"===e.filter&&(o.filter_variation=e["filter-variations"]||"all"),Object(u.recordEvent)("analytics_filter",o)}onAdvancedFilterAction(e,t){const{report:r,addCesSurveyForAnalytics:a}=this.props;switch(e){case"add":Object(u.recordEvent)("analytics_filters_add",{report:r,filter:t.key});break;case"remove":Object(u.recordEvent)("analytics_filters_remove",{report:r,filter:t.key});break;case"filter":const e=Object.keys(t).reduce((e,r)=>(e[Object(s.snakeCase)(r)]=t[r],e),{});a(),Object(u.recordEvent)("analytics_filters_filter",{report:r,...e});break;case"clear_all":Object(u.recordEvent)("analytics_filters_clear_all",{report:r});break;case"match":Object(u.recordEvent)("analytics_filters_all_any",{report:r,value:t.match})}}render(){const{advancedFilters:e,filters:t,path:r,query:o,showDatePicker:c,defaultDateRange:n}=this.props,{period:s,compare:i,before:d,after:u}=Object(m.getDateParamsFromQuery)(o,n),{primary:b,secondary:p}=Object(m.getCurrentDates)(o,n),y={period:s,compare:i,before:d,after:u,primaryDate:b,secondaryDate:p},h=this.context;return Object(a.createElement)(l.ReportFilters,{query:o,siteLocale:g.b.siteLocale,currency:h.getCurrencyConfig(),path:r,filters:t,advancedFilters:e,showDatePicker:c,onDateSelect:this.onDateSelect,onFilterSelect:this.onFilterSelect,onAdvancedFilterAction:this.onAdvancedFilterAction,dateQuery:y,isoDateFormat:m.isoDateFormat})}}y.contextType=b.a,t.a=Object(o.compose)(Object(i.withSelect)(e=>{const{woocommerce_default_date_range:t}=e(d.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{defaultDateRange:t}}),Object(i.withDispatch)(e=>{const{addCesSurveyForAnalytics:t}=e(p.c);return{addCesSurveyForAnalytics:t}}))(y),y.propTypes={advancedFilters:n.a.object,filters:n.a.array,path:n.a.string.isRequired,query:n.a.object,showDatePicker:n.a.bool,report:n.a.string.isRequired}},545:function(e,t,r){"use strict";var a=r(40),o=r.n(a),c=r(0),n=r(4),s=r(27),i=r(14),l=r(112),d=r(8),m=r(5),u=r(2),b=r(1),p=r.n(b),g=r(22),y=r(13),h=r(508),_=r(12),f=r(17),j=()=>Object(c.createElement)("svg",{role:"img","aria-hidden":"true",focusable:"false",version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 24 24"},Object(c.createElement)("path",{d:"M18,9c-0.009,0-0.017,0.002-0.025,0.003C17.72,5.646,14.922,3,11.5,3C7.91,3,5,5.91,5,9.5c0,0.524,0.069,1.031,0.186,1.519 C5.123,11.016,5.064,11,5,11c-2.209,0-4,1.791-4,4c0,1.202,0.541,2.267,1.38,3h18.593C22.196,17.089,23,15.643,23,14 C23,11.239,20.761,9,18,9z M12,16l-4-5h3V8h2v3h3L12,16z"})),O=r(537);var w=r(69);r(632);const S=e=>{const{getHeadersContent:t,getRowsContent:r,getSummary:a,isRequesting:i,primaryData:d,tableData:b,endpoint:p,itemIdField:w,tableQuery:S,compareBy:v,compareParam:C,searchBy:E,labels:F={},...R}=e,{query:D,columnPrefsKey:k}=e,{items:q,query:x}=b,A=D[C]?Object(y.getIdsFromQuery)(D[v]):[],[T,N]=Object(c.useState)(A),P=Object(c.useRef)(null),{updateUserPreferences:Q,...B}=Object(_.useUserPreferences)();if(b.isError||d.isError)return Object(c.createElement)(O.a,null);let I=[];k&&(I=B&&B[k]?B[k]:I);const M=(e,o,c)=>{const n=a?a(o,c):null;return Object(s.applyFilters)("woocommerce_admin_report_table",{endpoint:p,headers:t(),rows:r(e),totals:o,summary:n,items:q})},L=t=>{const{ids:r}=e;N(t?r:[])},U=(t,r)=>{const{ids:a}=e;if(r)N(Object(m.uniq)([a[t],...T]));else{const e=T.indexOf(a[t]);N([...T.slice(0,e),...T.slice(e+1)])}},V=t=>{const{ids:r=[]}=e,a=-1!==T.indexOf(r[t]);return{display:Object(c.createElement)(n.CheckboxControl,{onChange:Object(m.partial)(U,t),checked:a}),value:!1}},z=()=>{const{ids:t=[]}=e,r=t.length>0,a=r&&t.length===T.length;return{cellClassName:"is-checkbox-column",key:"compare",label:Object(c.createElement)(n.CheckboxControl,{onChange:L,"aria-label":Object(u.__)("Select All"),checked:a,disabled:!r}),required:!0}},G=i||b.isRequesting||d.isRequesting,H=Object(m.get)(d,["data","totals"],{}),J=q.totalResults||0,K=J>0,Y=Object(y.getSearchWords)(D).map(e=>({key:e,label:e})),{data:W}=q,X=M(W,H,J);let{headers:Z,rows:$}=X;const{summary:ee}=X;v&&($=$.map((e,t)=>[V(t),...e]),Z=[z(),...Z]);const te=((e,t)=>t?e.map(e=>({...e,visible:e.required||!t.includes(e.key)})):e.map(e=>({...e,visible:e.required||!e.hiddenByDefault})))(Z,I);return Object(c.createElement)(c.Fragment,null,Object(c.createElement)("div",{className:"woocommerce-report-table__scroll-point",ref:P,"aria-hidden":!0}),Object(c.createElement)(g.TableCard,o()({className:"woocommerce-report-table",hasSearch:!!E,actions:[v&&Object(c.createElement)(g.CompareButton,{key:"compare",className:"woocommerce-table__compare",count:T.length,helpText:F.helpText||Object(u.__)("Check at least two items below to compare","woocommerce-admin"),onClick:()=>{v&&Object(y.onQueryChange)("compare")(v,C,T.join(","))},disabled:!K},F.compareButton||Object(u.__)("Compare","woocommerce-admin")),E&&Object(c.createElement)(g.Search,{allowFreeTextSearch:!0,inlineTags:!0,key:"search",onChange:t=>{const{baseSearchQuery:r,addCesSurveyForCustomerSearch:a}=e,o=t.map(e=>e.label.replace(",","%2C"));o.length?(Object(y.updateQueryString)({filter:void 0,[C]:void 0,[E]:void 0,...r,search:Object(m.uniq)(o).join(",")}),a()):Object(y.updateQueryString)({search:void 0}),Object(f.recordEvent)("analytics_table_filter",{report:p})},placeholder:F.placeholder||Object(u.__)("Search by item name","woocommerce-admin"),selected:Y,showClearButton:!0,type:E,disabled:!K}),K&&Object(c.createElement)(n.Button,{key:"download",className:"woocommerce-table__download-button",disabled:G,onClick:()=>{const{createNotice:t,startExport:r,title:a}=e,o=Object.assign({},D),{data:c,totalResults:n}=q;let s="browser";if(delete o.extended_info,o.search&&delete o[E],c&&c.length===n){const{headers:e,rows:t}=M(c,n);Object(h.downloadCSVFile)(Object(h.generateCSVFileName)(a,o),Object(h.generateCSVDataFromTable)(e,t))}else s="email",r(p,x).then(()=>t("success",Object(u.sprintf)(Object(u.__)("Your %s Report will be emailed to you.","woocommerce-admin"),a))).catch(e=>t("error",e.message||Object(u.sprintf)(Object(u.__)("There was a problem exporting your %s Report. Please try again.","woocommerce-admin"),a)));Object(f.recordEvent)("analytics_table_download",{report:p,rows:n,download_type:s})}},Object(c.createElement)(j,null),Object(c.createElement)("span",{className:"woocommerce-table__download-button__label"},F.downloadButton||Object(u.__)("Download","woocommerce-admin")))],headers:te,isLoading:G,onQueryChange:y.onQueryChange,onColumnsChange:(e,t)=>{const r=Z.map(e=>e.key).filter(t=>!e.includes(t));if(k){Q({[k]:r})}if(t){const r={report:p,column:t,status:e.includes(t)?"on":"off"};Object(f.recordEvent)("analytics_table_header_toggle",r)}},onSort:(e,t)=>{Object(y.onQueryChange)("sort")(e,t);const r={report:p,column:e,direction:t};Object(f.recordEvent)("analytics_table_sort",r)},onPageChange:(e,t)=>{P.current.scrollIntoView();const r=P.current.nextSibling.querySelector(".woocommerce-table__table"),a=l.focus.focusable.find(r);a.length&&a[0].focus(),t&&("goto"===t?Object(f.recordEvent)("analytics_table_go_to_page",{report:p,page:e}):Object(f.recordEvent)("analytics_table_page_click",{report:p,direction:t}))},rows:$,rowsPerPage:parseInt(x.per_page,10)||_.QUERY_DEFAULTS.pageSize,summary:ee,totalRows:J},R)))};S.propTypes={baseSearchQuery:p.a.object,compareBy:p.a.string,compareParam:p.a.string,columnPrefsKey:p.a.string,endpoint:p.a.string,extendItemsMethodNames:p.a.shape({getError:p.a.string,isRequesting:p.a.string,load:p.a.string}),extendedItemsStoreName:p.a.string,getHeadersContent:p.a.func.isRequired,getRowsContent:p.a.func.isRequired,getSummary:p.a.func,itemIdField:p.a.string,labels:p.a.shape({compareButton:p.a.string,downloadButton:p.a.string,helpText:p.a.string,placeholder:p.a.string}),primaryData:p.a.object,searchBy:p.a.string,summaryFields:p.a.arrayOf(p.a.string),tableData:p.a.object.isRequired,tableQuery:p.a.object,title:p.a.string.isRequired},S.defaultProps={primaryData:{},tableData:{items:{data:[],totalResults:0},query:{}},tableQuery:{},compareParam:"filter",downloadable:!1,onSearch:m.noop,baseSearchQuery:{}};const v=[],C={};t.a=Object(i.compose)(Object(d.withSelect)((e,t)=>{const{endpoint:r,getSummary:a,isRequesting:o,itemIdField:c,query:n,tableData:s,tableQuery:i,filters:l,advancedFilters:d,summaryFields:u,extendedItemsStoreName:b}=t,p=e(_.REPORTS_STORE_NAME),g=b?e(b):null,{woocommerce_default_date_range:y}=e(_.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),h=n.search&&!(n[r]&&n[r].length);if(o||h)return C;const f="categories"===r?"products":r,j=a?Object(_.getReportChartData)({endpoint:f,selector:p,dataType:"primary",query:n,filters:l,advancedFilters:d,defaultDateRange:y,fields:u}):C,O=s||Object(_.getReportTableData)({endpoint:r,query:n,selector:p,tableQuery:i,filters:l,advancedFilters:d,defaultDateRange:y}),w=g?function(e,t,r){const{extendItemsMethodNames:a,itemIdField:o}=t,c=r.items.data;if(!(Array.isArray(c)&&c.length&&a&&o))return r;const{[a.getError]:n,[a.isRequesting]:s,[a.load]:i}=e,l={include:c.map(e=>e[o]).join(","),per_page:c.length},d=i(l),u=!!s&&s(l),b=!!n&&n(l),p=c.map(e=>{const t=Object(m.first)(d.filter(t=>e.id===t.id));return{...e,...t}}),g=r.isRequesting||u,y=r.isError||b;return{...r,isRequesting:g,isError:y,items:{...r.items,data:p}}}(g,t,O):O;return{primaryData:j,ids:c&&w.items.data?w.items.data.map(e=>e[c]):v,tableData:w,query:n}}),Object(d.withDispatch)(e=>{const{startExport:t}=e(_.EXPORT_STORE_NAME),{createNotice:r}=e("core/notices"),{addCesSurveyForCustomerSearch:a}=e(w.c);return{createNotice:r,startExport:t,addCesSurveyForCustomerSearch:a}}))(S)},632:function(e,t,r){}}]);