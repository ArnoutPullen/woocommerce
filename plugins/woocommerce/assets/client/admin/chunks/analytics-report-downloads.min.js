(window.__wcAdmin_webpackJsonp=window.__wcAdmin_webpackJsonp||[]).push([[11],{519:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return C}));var a=r(0),o=r(1),n=r.n(o),c=r(568),s=r(2),i=r(8),l=r(5),d=r(11),m=r.n(d),u=r(22),p=r(13),b=r(136),y=r(15),_=r(12),f=r(20),g=r(545),h=r(536),O=r(23);class j extends a.Component{constructor(){super(),this.getHeadersContent=this.getHeadersContent.bind(this),this.getRowsContent=this.getRowsContent.bind(this),this.getSummary=this.getSummary.bind(this)}getHeadersContent(){return[{label:Object(s.__)("Date","woocommerce-admin"),key:"date",defaultSort:!0,required:!0,isLeftAligned:!0,isSortable:!0},{label:Object(s.__)("Product title","woocommerce-admin"),key:"product",isSortable:!0,required:!0},{label:Object(s.__)("File name","woocommerce-admin"),key:"file_name"},{label:Object(s.__)("Order #","woocommerce-admin"),screenReaderLabel:Object(s.__)("Order Number","woocommerce-admin"),key:"order_number"},{label:Object(s.__)("Username","woocommerce-admin"),key:"user_id"},{label:Object(s.__)("IP","woocommerce-admin"),key:"ip_address"}]}getRowsContent(e){const{query:t}=this.props,r=Object(p.getPersistedQuery)(t),o=Object(O.d)("dateFormat",f.defaultTableDateFormat);return Object(l.map)(e,e=>{const{_embedded:t,date:n,file_name:c,file_path:i,ip_address:l,order_id:d,order_number:m,product_id:b,username:_}=e,{code:f,name:g}=t.product[0];let h,O;if("woocommerce_rest_product_invalid_id"===f)h=Object(s.__)("(Deleted)","woocommerce-admin"),O=Object(s.__)("(Deleted)","woocommerce-admin");else{const e=Object(p.getNewPath)(r,"/analytics/products",{filter:"single_product",products:b});h=Object(a.createElement)(u.Link,{href:e,type:"wc-admin"},g),O=g}return[{display:Object(a.createElement)(u.Date,{date:n,visibleFormat:o}),value:n},{display:h,value:O},{display:Object(a.createElement)(u.Link,{href:i,type:"external"},c),value:c},{display:Object(a.createElement)(u.Link,{href:Object(y.getAdminLink)(`post.php?post=${d}&action=edit`),type:"wp-admin"},m),value:m},{display:_,value:_},{display:l,value:l}]})}getSummary(e){const{download_count:t=0}=e,{query:r,defaultDateRange:a}=this.props,o=Object(f.getCurrentDates)(r,a),n=m()(o.primary.after),c=m()(o.primary.before).diff(n,"days")+1,i=this.context.getCurrencyConfig();return[{label:Object(s._n)("day","days",c,"woocommerce-admin"),value:Object(b.formatValue)(i,"number",c)},{label:Object(s._n)("Download","Downloads",t,"woocommerce-admin"),value:Object(b.formatValue)(i,"number",t)}]}render(){const{query:e,filters:t,advancedFilters:r}=this.props;return Object(a.createElement)(g.a,{endpoint:"downloads",getHeadersContent:this.getHeadersContent,getRowsContent:this.getRowsContent,getSummary:this.getSummary,summaryFields:["download_count"],query:e,tableQuery:{_embed:!0},title:Object(s.__)("Downloads","woocommerce-admin"),columnPrefsKey:"downloads_report_columns",filters:t,advancedFilters:r})}}j.contextType=h.a;var w=Object(i.withSelect)(e=>{const{woocommerce_default_date_range:t}=e(_.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{defaultDateRange:t}})(j),v=r(542),R=r(540),S=r(543),D=r(544);class C extends a.Component{render(){const{query:e,path:t}=this.props;return Object(a.createElement)(a.Fragment,null,Object(a.createElement)(D.a,{query:e,path:t,filters:c.c,advancedFilters:c.a,report:"downloads"}),Object(a.createElement)(S.a,{charts:c.b,endpoint:"downloads",query:e,selectedChart:Object(v.a)(e.chart,c.b),filters:c.c,advancedFilters:c.a}),Object(a.createElement)(R.a,{charts:c.b,endpoint:"downloads",path:t,query:e,selectedChart:Object(v.a)(e.chart,c.b),filters:c.c,advancedFilters:c.a}),Object(a.createElement)(w,{query:e,filters:c.c,advancedFilters:c.a}))}}C.propTypes={query:n.a.object.isRequired}},538:function(e,t,r){"use strict";r.d(t,"e",(function(){return m})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return y})),r.d(t,"f",(function(){return _})),r.d(t,"h",(function(){return f})),r.d(t,"g",(function(){return g}));var a=r(16),o=r(21),n=r.n(o),c=r(5),s=r(13),i=r(12),l=r(539),d=r(23);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.identity;return function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;const c="function"==typeof e?e(o):e,i=Object(s.getIdsFromQuery)(r);if(i.length<1)return Promise.resolve([]);const l={include:i.join(","),per_page:i.length};return n()({path:Object(a.addQueryArgs)(c,l)}).then(e=>e.map(t))}}m(i.NAMESPACE+"/products/attributes",e=>({key:e.id,label:e.name}));const u=m(i.NAMESPACE+"/products/categories",e=>({key:e.id,label:e.name})),p=m(i.NAMESPACE+"/coupons",e=>({key:e.id,label:e.code})),b=m(i.NAMESPACE+"/customers",e=>({key:e.id,label:e.name})),y=m(i.NAMESPACE+"/products",e=>({key:e.id,label:e.name})),_=m(i.NAMESPACE+"/taxes",e=>({key:e.id,label:Object(l.a)(e)}));function f(e){let{attributes:t,name:r}=e;const a=Object(d.d)("variationTitleAttributesSeparator"," - ");if(r&&r.indexOf(a)>-1)return r;const o=(t||[]).map(e=>{let{option:t}=e;return t}).join(", ");return o?r+a+o:r}const g=m(e=>{let{products:t}=e;return t?i.NAMESPACE+`/products/${t}/variations`:i.NAMESPACE+"/variations"},e=>({key:e.id,label:f(e)}))},539:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(2);function o(e){return[e.country,e.state,e.name||Object(a.__)("TAX","woocommerce-admin"),e.priority].map(e=>e.toString().toUpperCase().trim()).filter(Boolean).join("-")}},540:function(e,t,r){"use strict";var a=r(0),o=r(2),n=r(14),c=r(68),s=r(8),i=r(5),l=r(1),d=r.n(l),m=r(22),u=r(12),p=r(20),b=r(536),y=r(537),_=r(13);function f(e){return t=>Object(c.format)(e,t)}class g extends a.Component{shouldComponentUpdate(e){return e.isRequesting!==this.props.isRequesting||e.primaryData.isRequesting!==this.props.primaryData.isRequesting||e.secondaryData.isRequesting!==this.props.secondaryData.isRequesting||!Object(i.isEqual)(e.query,this.props.query)}getItemChartData(){const{primaryData:e,selectedChart:t}=this.props;return e.data.intervals.map((function(e){const r={};return e.subtotals.segments.forEach((function(e){if(e.segment_label){const a=r[e.segment_label]?e.segment_label+" (#"+e.segment_id+")":e.segment_label;r[e.segment_id]={label:a,value:e.subtotals[t.key]||0}}})),{date:Object(c.format)("Y-m-d\\TH:i:s",e.date_start),...r}}))}getTimeChartData(){const{query:e,primaryData:t,secondaryData:r,selectedChart:a,defaultDateRange:o}=this.props,n=Object(p.getIntervalForQuery)(e,o),{primary:s,secondary:i}=Object(p.getCurrentDates)(e,o);return t.data.intervals.map((function(t,o){const l=Object(p.getPreviousDate)(t.date_start,s.after,i.after,e.compare,n),d=r.data.intervals[o];return{date:Object(c.format)("Y-m-d\\TH:i:s",t.date_start),primary:{label:`${s.label} (${s.range})`,labelDate:t.date_start,value:t.subtotals[a.key]||0},secondary:{label:`${i.label} (${i.range})`,labelDate:l.format("YYYY-MM-DD HH:mm:ss"),value:d&&d.subtotals[a.key]||0}}}))}getTimeChartTotals(){const{primaryData:e,secondaryData:t,selectedChart:r}=this.props;return{primary:Object(i.get)(e,["data","totals",r.key],null),secondary:Object(i.get)(t,["data","totals",r.key],null)}}renderChart(e,t,r,n){const{emptySearchResults:c,filterParam:s,interactiveLegend:i,itemsLabel:l,legendPosition:d,path:b,query:y,selectedChart:_,showHeaderControls:g,primaryData:h,defaultDateRange:O}=this.props,j=Object(p.getIntervalForQuery)(y,O),w=Object(p.getAllowedIntervalsForQuery)(y,O),v=Object(p.getDateFormatsForInterval)(j,h.data.intervals.length,{type:"php"}),R=c?Object(o.__)("No data for the current search","woocommerce-admin"):Object(o.__)("No data for the selected date range","woocommerce-admin"),{formatAmount:S,getCurrencyConfig:D}=this.context;return Object(a.createElement)(m.Chart,{allowedIntervals:w,data:r,dateParser:"%Y-%m-%dT%H:%M:%S",emptyMessage:R,filterParam:s,interactiveLegend:i,interval:j,isRequesting:t,itemsLabel:l,legendPosition:d,legendTotals:n,mode:e,path:b,query:y,screenReaderFormat:f(v.screenReaderFormat),showHeaderControls:g,title:_.label,tooltipLabelFormat:f(v.tooltipLabelFormat),tooltipTitle:"time-comparison"===e&&_.label||null,tooltipValueFormat:Object(u.getTooltipValueFormat)(_.type,S),chartType:Object(p.getChartTypeForQuery)(y),valueType:_.type,xFormat:f(v.xFormat),x2Format:f(v.x2Format),currency:D()})}renderItemComparison(){const{isRequesting:e,primaryData:t}=this.props;if(t.isError)return Object(a.createElement)(y.a,null);const r=e||t.isRequesting,o=this.getItemChartData();return this.renderChart("item-comparison",r,o)}renderTimeComparison(){const{isRequesting:e,primaryData:t,secondaryData:r}=this.props;if(!t||t.isError||r.isError)return Object(a.createElement)(y.a,null);const o=e||t.isRequesting||r.isRequesting,n=this.getTimeChartData(),c=this.getTimeChartTotals();return this.renderChart("time-comparison",o,n,c)}render(){const{mode:e}=this.props;return"item-comparison"===e?this.renderItemComparison():this.renderTimeComparison()}}g.contextType=b.a,g.propTypes={filters:d.a.array,isRequesting:d.a.bool,itemsLabel:d.a.string,limitProperties:d.a.array,mode:d.a.string,path:d.a.string.isRequired,primaryData:d.a.object,query:d.a.object.isRequired,secondaryData:d.a.object,selectedChart:d.a.shape({key:d.a.string.isRequired,label:d.a.string.isRequired,order:d.a.oneOf(["asc","desc"]),orderby:d.a.string,type:d.a.oneOf(["average","number","currency"]).isRequired}).isRequired},g.defaultProps={isRequesting:!1,primaryData:{data:{intervals:[]},isError:!1,isRequesting:!1},secondaryData:{data:{intervals:[]},isError:!1,isRequesting:!1}};t.a=Object(n.compose)(Object(s.withSelect)((e,t)=>{const{charts:r,endpoint:a,filters:o,isRequesting:n,limitProperties:c,query:s,advancedFilters:l}=t,d=c||[a],m=function e(t,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t||0===t.length)return null;const o=t.slice(0),n=o.pop();if(n.showFilters(r,a)){const e=Object(_.flattenFilters)(n.filters),t=r[n.param]||n.defaultValue||"all";return Object(i.find)(e,{value:t})}return e(o,r,a)}(o,s),p=Object(i.get)(m,["settings","param"]),b=t.mode||function(e,t){if(e&&t){const r=Object(i.get)(e,["settings","param"]);if(!r||Object.keys(t).includes(r))return Object(i.get)(e,["chartMode"])}return null}(m,s)||"time-comparison",{woocommerce_default_date_range:y}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings"),f=e(u.REPORTS_STORE_NAME),g={mode:b,filterParam:p,defaultDateRange:y};if(n)return g;const h=d.some(e=>s[e]&&s[e].length);if(s.search&&!h)return{...g,emptySearchResults:!0};const O=r&&r.map(e=>e.key),j=Object(u.getReportChartData)({endpoint:a,dataType:"primary",query:s,selector:f,limitBy:d,filters:o,advancedFilters:l,defaultDateRange:y,fields:O});if("item-comparison"===b)return{...g,primaryData:j};const w=Object(u.getReportChartData)({endpoint:a,dataType:"secondary",query:s,selector:f,limitBy:d,filters:o,advancedFilters:l,defaultDateRange:y,fields:O});return{...g,primaryData:j,secondaryData:w}}))(g)},542:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(5);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=Object(a.find)(t,{key:e});return r||t[0]}},543:function(e,t,r){"use strict";var a=r(0),o=r(2),n=r(14),c=r(8),s=r(1),i=r.n(s),l=r(13),d=r(22),m=r(136),u=r(12),p=r(20),b=r(17),y=r(537),_=r(536);class f extends a.Component{formatVal(e,t){const{formatAmount:r,getCurrencyConfig:a}=this.context;return"currency"===t?r(e):Object(m.formatValue)(a(),t,e)}getValues(e,t){const{emptySearchResults:r,summaryData:a}=this.props,{totals:o}=a,n=o.primary?o.primary[e]:0,c=o.secondary?o.secondary[e]:0,s=r?0:n,i=r?0:c;return{delta:Object(m.calculateDelta)(s,i),prevValue:this.formatVal(i,t),value:this.formatVal(s,t)}}render(){const{charts:e,query:t,selectedChart:r,summaryData:n,endpoint:c,report:s,defaultDateRange:i}=this.props,{isError:m,isRequesting:u}=n;if(m)return Object(a.createElement)(y.a,null);if(u)return Object(a.createElement)(d.SummaryListPlaceholder,{numberOfItems:e.length});const{compare:_}=Object(p.getDateParamsFromQuery)(t,i);return Object(a.createElement)(d.SummaryList,null,t=>{let{onToggle:n}=t;return e.map(e=>{const{key:t,order:i,orderby:m,label:u,type:p,isReverseTrend:y,labelTooltipText:f}=e,g={chart:t};m&&(g.orderby=m),i&&(g.order=i);const h=Object(l.getNewPath)(g),O=r.key===t,{delta:j,prevValue:w,value:v}=this.getValues(t,p);return Object(a.createElement)(d.SummaryNumber,{key:t,delta:j,href:h,label:u,reverseTrend:y,prevLabel:"previous_period"===_?Object(o.__)("Previous period:","woocommerce-admin"):Object(o.__)("Previous year:","woocommerce-admin"),prevValue:w,selected:O,value:v,labelTooltipText:f,onLinkClickCallback:()=>{n&&n(),Object(b.recordEvent)("analytics_chart_tab_click",{report:s||c,key:t})}})})})}}f.propTypes={charts:i.a.array.isRequired,endpoint:i.a.string.isRequired,limitProperties:i.a.array,query:i.a.object.isRequired,selectedChart:i.a.shape({key:i.a.string.isRequired,label:i.a.string.isRequired,order:i.a.oneOf(["asc","desc"]),orderby:i.a.string,type:i.a.oneOf(["average","number","currency"]).isRequired}).isRequired,summaryData:i.a.object,report:i.a.string},f.defaultProps={summaryData:{totals:{primary:{},secondary:{}},isError:!1}},f.contextType=_.a,t.a=Object(n.compose)(Object(c.withSelect)((e,t)=>{const{charts:r,endpoint:a,limitProperties:o,query:n,filters:c,advancedFilters:s}=t,i=o||[a],l=i.some(e=>n[e]&&n[e].length);if(n.search&&!l)return{emptySearchResults:!0};const d=r&&r.map(e=>e.key),{woocommerce_default_date_range:m}=e(u.SETTINGS_STORE_NAME).getSetting("wc_admin","wcAdminSettings");return{summaryData:Object(u.getSummaryNumbers)({endpoint:a,query:n,select:e,limitBy:i,filters:c,advancedFilters:s,defaultDateRange:m,fields:d}),defaultDateRange:m}}))(f)},568:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return s})),r.d(t,"a",(function(){return i}));var a=r(2),o=r(27),n=r(538);const c=Object(o.applyFilters)("woocommerce_admin_downloads_report_charts",[{key:"download_count",label:Object(a.__)("Downloads","woocommerce-admin"),type:"number"}]),s=Object(o.applyFilters)("woocommerce_admin_downloads_report_filters",[{label:Object(a.__)("Show","woocommerce-admin"),staticParams:["chartType","paged","per_page"],param:"filter",showFilters:()=>!0,filters:[{label:Object(a.__)("All downloads","woocommerce-admin"),value:"all"},{label:Object(a.__)("Advanced filters","woocommerce-admin"),value:"advanced"}]}]),i=Object(o.applyFilters)("woocommerce_admin_downloads_report_advanced_filters",{title:Object(a._x)("Downloads match {{select /}} filters","A sentence describing filters for Downloads. See screen shot for context: https://cloudup.com/ccxhyH2mEDg","woocommerce-admin"),filters:{product:{labels:{add:Object(a.__)("Product","woocommerce-admin"),placeholder:Object(a.__)("Search","woocommerce-admin"),remove:Object(a.__)("Remove product filter","woocommerce-admin"),rule:Object(a.__)("Select a product filter match","woocommerce-admin"),title:Object(a.__)("{{title}}Product{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(a.__)("Select product","woocommerce-admin")},rules:[{value:"includes",label:Object(a._x)("Includes","products","woocommerce-admin")},{value:"excludes",label:Object(a._x)("Excludes","products","woocommerce-admin")}],input:{component:"Search",type:"products",getLabels:n.d}},customer:{labels:{add:Object(a.__)("Username","woocommerce-admin"),placeholder:Object(a.__)("Search customer username","woocommerce-admin"),remove:Object(a.__)("Remove customer username filter","woocommerce-admin"),rule:Object(a.__)("Select a customer username filter match","woocommerce-admin"),title:Object(a.__)("{{title}}Username{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(a.__)("Select customer username","woocommerce-admin")},rules:[{value:"includes",label:Object(a._x)("Includes","customer usernames","woocommerce-admin")},{value:"excludes",label:Object(a._x)("Excludes","customer usernames","woocommerce-admin")}],input:{component:"Search",type:"usernames",getLabels:n.c}},order:{labels:{add:Object(a.__)("Order #","woocommerce-admin"),placeholder:Object(a.__)("Search order number","woocommerce-admin"),remove:Object(a.__)("Remove order number filter","woocommerce-admin"),rule:Object(a.__)("Select a order number filter match","woocommerce-admin"),title:Object(a.__)("{{title}}Order #{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(a.__)("Select order number","woocommerce-admin")},rules:[{value:"includes",label:Object(a._x)("Includes","order numbers","woocommerce-admin")},{value:"excludes",label:Object(a._x)("Excludes","order numbers","woocommerce-admin")}],input:{component:"Search",type:"orders",getLabels:async e=>{const t=e.split(",");return await t.map(e=>({id:e,label:"#"+e}))}}},ip_address:{labels:{add:Object(a.__)("IP Address","woocommerce-admin"),placeholder:Object(a.__)("Search IP address","woocommerce-admin"),remove:Object(a.__)("Remove IP address filter","woocommerce-admin"),rule:Object(a.__)("Select an IP address filter match","woocommerce-admin"),title:Object(a.__)("{{title}}IP Address{{/title}} {{rule /}} {{filter /}}","woocommerce-admin"),filter:Object(a.__)("Select IP address","woocommerce-admin")},rules:[{value:"includes",label:Object(a._x)("Includes","IP addresses","woocommerce-admin")},{value:"excludes",label:Object(a._x)("Excludes","IP addresses","woocommerce-admin")}],input:{component:"Search",type:"downloadIps",getLabels:async e=>{const t=e.split(",");return await t.map(e=>({id:e,label:e}))}}}}})}}]);